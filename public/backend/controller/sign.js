"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _asyncToGenerator(e){return function(){var r=e.apply(this,arguments);return new Promise(function(e,t){function n(a,o){try{var i=r[a](o),u=i.value}catch(e){return void t(e)}if(!i.done)return Promise.resolve(u).then(function(e){n("next",e)},function(e){n("throw",e)});e(u)}return n("next")})}}Object.defineProperty(exports,"__esModule",{value:!0});var _regenerator=require("babel-runtime/regenerator"),_regenerator2=_interopRequireDefault(_regenerator),_fs=require("fs"),_fs2=_interopRequireDefault(_fs),_config=require("../utils/config"),_config2=_interopRequireDefault(_config),register=function(){var e=_asyncToGenerator(_regenerator2.default.mark(function e(r,t){return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.render("./frontend/sign",{title:"注册",type:0});case 2:case"end":return e.stop()}},e,void 0)}));return function(r,t){return e.apply(this,arguments)}}(),login=function(){var e=_asyncToGenerator(_regenerator2.default.mark(function e(r,t){return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.render("./frontend/sign",{title:"登录",type:1});case 2:case"end":return e.stop()}},e,void 0)}));return function(r,t){return e.apply(this,arguments)}}(),registerHandle=function(){var e=_asyncToGenerator(_regenerator2.default.mark(function e(r,t){var n,a,o,i,u;return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=r.request.body.files,a=(new Date).getTime()+n.imgs.name.substr(n.imgs.name.lastIndexOf(".")),o=_fs2.default.createReadStream(n.imgs.path),i=_fs2.default.createWriteStream(_config2.default.uploadPath+a),o.pipe(i),u=_config2.default.uploadLocalPath+a,r.body=u;case 7:case"end":return e.stop()}},e,void 0)}));return function(r,t){return e.apply(this,arguments)}}();exports.default={register:register,registerHandle:registerHandle,login:login};