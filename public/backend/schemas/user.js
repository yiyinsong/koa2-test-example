"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _asyncToGenerator(e){return function(){var r=e.apply(this,arguments);return new Promise(function(e,t){function n(a,u){try{var o=r[a](u),i=o.value}catch(e){return void t(e)}if(!o.done)return Promise.resolve(i).then(function(e){n("next",e)},function(e){n("throw",e)});e(i)}return n("next")})}}Object.defineProperty(exports,"__esModule",{value:!0});var _regenerator=require("babel-runtime/regenerator"),_regenerator2=_interopRequireDefault(_regenerator),_mongoose=require("mongoose"),_mongoose2=_interopRequireDefault(_mongoose),Schema=_mongoose2.default.Schema,UserSchema=new Schema({_id:{type:Number,unique:!0,required:!0},username:{type:String,unique:!0,required:!0},tel:{type:String,unique:!0,required:!0},password:{type:String},icon:String,meta:{createTime:{type:Date,default:Date.now()},updateTime:{type:Date,default:Date.now()}}});UserSchema.pre("save",function(e){this.isNew?this.meta.createTime=this.meta.updateTime=Date.now():this.meta.updateTime=Date.now(),e()}),UserSchema.statics={fetch:function(){var e=_asyncToGenerator(_regenerator2.default.mark(function e(){var r;return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.find({}).sort("meta.createTime");case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),findByName:function(){var e=_asyncToGenerator(_regenerator2.default.mark(function e(r){var t;return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.findOne({username:r});case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}},e,this)}));return function(r){return e.apply(this,arguments)}}(),findByTel:function(){var e=_asyncToGenerator(_regenerator2.default.mark(function e(r){var t;return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.findOne({tel:r});case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}},e,this)}));return function(r){return e.apply(this,arguments)}}(),findPasswordByName:function(){var e=_asyncToGenerator(_regenerator2.default.mark(function e(r){var t;return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.findOne({username:r});case 2:return t=e.sent,e.abrupt("return",t&&t.password||null);case 4:case"end":return e.stop()}},e,this)}));return function(r){return e.apply(this,arguments)}}(),findPasswordByTel:function(){var e=_asyncToGenerator(_regenerator2.default.mark(function e(r){var t;return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.findOne({tel:r});case 2:return t=e.sent,e.abrupt("return",t&&t.password||null);case 4:case"end":return e.stop()}},e,this)}));return function(r){return e.apply(this,arguments)}}()},exports.default=UserSchema;